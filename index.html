<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sun Salutation 10950 </title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            height: 100vh;
        }
        
        .section {
            position: absolute;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: left;
            justify-content: left;
            padding: 20px;
            top: 0;
            left: 0;
            transition: transform 0.8s ease-in-out;
        }
        
        #poemSection {
            transform: translateY(0);
        }
        
        #poemSection.slide-up {
            transform: translateY(-100vh);
        }
        
        #headingSection {
            transform: translateY(100vh);
        }
        
        #headingSection.active {
            transform: translateY(0);
        }

        #layeredArtSection {
            display: none; /* Hidden by default */
            position: relative;
        }

        .layered-art-container {
            position: relative;
            font-family: 'Courier New', monospace;
            white-space: pre;
        }

        .layered-art-container div {
            position: absolute;
            top: 0;
            left: 0;
        }

        #python-art {
            font-size: 0.58vw; /* 7px base */
        }

        #bday-art-overlay {
            font-size: 0.42vw; /* 5px base */
            /* Initial positioning guess */
            top: 50px; 
            left: 150px;
            color: white; /* Make it stand out */
        }
        
        .side-by-side-container {
            display: flex;
            justify-content: space-between; /* Change to space-between */
            align-items: flex-start;
            width: 100%;
        }

        .poem-container {
            flex-basis: 100%;
        }
        
        .typewriter-container {
            white-space: pre;
            font-size: 1vw; /* 12px base */
            line-height: 1.4;
            letter-spacing: 1px;
            text-align: left;
            max-width: 50%;
        }

        #poemSection .typewriter-container {
            text-align: left;
        }
        
        .later-sections {
            text-align: left;
            align-items: flex-start;
            justify-content: flex-start;
            padding: 20px;
        }
        
        .later-sections .typewriter-container {
            width: 100%;
            max-width: none;
        }
        
        .cursor {
            animation: blink 1s infinite;
            color: #00ff41;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .typewriter-text {
            color: #00ff41;
            text-shadow: 0 0 5px #00ff41;
            font-size: 1.17vw; /* 14px base */
        }
        
        .typewriter-text.poem {
            font-size: 14px; /* User preference */
        }
        
        .typewriter-text.indras-net-art {
            font-size: 0.75vw; /* Adjusted for better fit */
            color: white;
            text-shadow: none;
        }
        
        .typewriter-text.heading {
            font-size: 0.83vw; /* 10px base */
            text-align: left;
        }
        
        .typewriter-text.birthday {
            font-size: 0.67vw; /* 8px base */
            text-align: left;
            margin-top: 20px;
        }
        
        .typewriter-text.python {
            font-size: 0.5vw; /* 6px base */
            text-align: left;
            margin-top: 20px;
        }

        .typewriter-text.exaltation-art {
            font-size: 0.6vw; /* 5px base */
            color: #FF69B4; /* Pink */
            text-shadow: 0 0 5px #FF69B4, 0 0 10px #FF69B4;
        }

        .typewriter-text.with-love-art {
            font-size: 0.4vw;
            color: #FFC0CB; /* Lighter Pink */
            text-shadow: 0 0 5px #FFC0CB;
        }

        /* Subtle glow effect */
        .glow {
            text-shadow: 
                0 0 5px #00ff41,
                0 0 10px #00ff41,
                0 0 15px #00ff41;
        }
        
        /* Continue button styling */
        .continue-button {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: transparent;
            border: 1px solid white;
            color: #00ff41;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3);
        }
        
        .continue-button:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.4);
        }

        .continue-button.pink {
            color: #FF69B4;
            border-color: #FF69B4;
        }
    </style>
</head>
<body>
    <!-- Section 1: Saturn Poem -->
    <div class="section" id="poemSection">
        <div class="side-by-side-container">
            <div class="typewriter-container poem-container">
                <div class="typewriter-text poem" id="typewriter"></div>
                <span class="cursor" id="cursor">_</span>
            </div>
        </div>
        <button id="continueBtn" class="continue-button" style="display: none;">↓</button>
    </div>

    <!-- Section 2: Cristina Heading & Birthday Text -->
    <div class="section later-sections" id="headingSection">
        <div class="typewriter-container">
            <div class="typewriter-text heading" id="headingText"></div>
            <div class="typewriter-text birthday" id="birthdayText" style="margin-top: 20px;"></div>
            <div class="typewriter-text python" id="pythonText" style="margin-top: 20px;"></div>
        </div>
    </div>

    <!-- Section 3: Layered ASCII Art -->
    <div class="section later-sections" id="layeredArtSection">
        <div class="layered-art-container">
            <div id="python-art" class="python-base"></div>
            <div id="bday-art-overlay" class="bday-overlay"></div>
        </div>
    </div>

    <!-- Section 5: Exaltation Art -->
    <div class="section later-sections" id="exaltationSection" style="display: none;">
        <div class="typewriter-container">
            <div class="typewriter-text exaltation-art" id="exaltationText"></div>
            <div class="typewriter-text with-love-art" id="withLoveText" style="margin-top: 20px;"></div>
        </div>
        <button id="continueBtn3" class="continue-button pink" style="display: none;">↓</button>
    </div>

    <script>
        const typewriter = document.getElementById('typewriter');
        const cursor = document.getElementById('cursor');
        const continueBtn = document.getElementById('continueBtn');
        const headingText = document.getElementById('headingText');
        const birthdayDiv = document.getElementById('birthdayText');
        const continueBtn3 = document.getElementById('continueBtn3');
        
        let currentPhase = 'saturn';
        let activeSkippers = [];

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                // Make a copy as skipper() can modify the array during iteration
                [...activeSkippers].forEach(skipper => skipper());
            }
        });
        
        /**
         * A reusable function to load ASCII art from a file and animate it.
         * @param {string} filePath - The path to the ASCII art text file.
         * @param {string} elementId - The ID of the element to display the art in.
         * @param {object} options - Configuration options.
         * @param {number} [options.lineDelay=200] - Delay between printing each line.
         * @param {boolean} [options.autoScroll=false] - Whether to scroll the view as content is added.
         * @param {string} [options.charAnimation='line'] - 'line' for line-by-line, 'char' for char-by-char.
         * @param {number} [options.charSpeed=25] - Speed for character-by-character animation.
         * @param {function} [options.onComplete=null] - Callback function when animation is done.
         */
        function loadAndAnimateAscii(url, elementId, options = {}) {
            const {
                charAnimation = 'line',
                charSpeed = 25,
                lineDelay = 200,
                onComplete,
                autoScroll = false
            } = options;
            
            const typewriterElement = document.getElementById(elementId);
            if (!typewriterElement) {
                console.error(`Element with ID "${elementId}" not found.`);
                return;
            }
            
            const cursor = typewriterElement.parentElement.querySelector('.cursor');

            if (cursor) {
                cursor.style.display = 'inline';
            }

            let timeoutId;
            let completed = false;
            let fullText = '';

            const skipper = () => {
                if (completed) return;
                completed = true;
                clearTimeout(timeoutId);

                if (charAnimation === 'char') {
                    typewriterElement.textContent = fullText;
                } else {
                    typewriterElement.innerHTML = fullText;
                }

                if (cursor) cursor.style.display = 'none';
                if (onComplete) onComplete();
                
                const index = activeSkippers.indexOf(skipper);
                if (index > -1) {
                    activeSkippers.splice(index, 1);
                }
            };

            activeSkippers.push(skipper);

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(text => {
                    fullText = text;
                    typewriterElement.style.whiteSpace = 'pre';
                    
                    if (charAnimation === 'char') {
                        let charIndex = 0;
                        function type() {
                            if (completed) return;
                            if (charIndex < text.length) {
                                typewriterElement.textContent += text.charAt(charIndex);
                                if (autoScroll) {
                                    typewriterElement.scrollIntoView({ behavior: 'smooth', block: 'end' });
                                }
                                charIndex++;
                                timeoutId = setTimeout(type, charSpeed);
                            } else {
                                if (cursor) cursor.style.display = 'none';
                                if (onComplete) onComplete();
                                completed = true;
                                const index = activeSkippers.indexOf(skipper);
                                if (index > -1) {
                                    activeSkippers.splice(index, 1);
                                }
                            }
                        }
                        type();
                    } else { // line-by-line
                        const lines = text.split('\n');
                        let lineIndex = 0;
                        function printLine() {
                            if (completed) return;
                            if (lineIndex < lines.length) {
                                typewriterElement.innerHTML += (lines[lineIndex] + '\n');
                                if (autoScroll) {
                                    typewriterElement.scrollIntoView({ behavior: 'smooth', block: 'end' });
                                }
                                lineIndex++;
                                timeoutId = setTimeout(printLine, lineDelay);
                            } else {
                                if (cursor) cursor.style.display = 'none';
                                if (onComplete) onComplete();
                                completed = true;
                                const index = activeSkippers.indexOf(skipper);
                                if (index > -1) {
                                    activeSkippers.splice(index, 1);
                                }
                            }
                        }
                        printLine();
                    }
                })
                .catch(error => {
                    console.error(`Error loading ASCII from ${url}:`, error);
                    typewriterElement.textContent = `Error: Could not load content from ${url}.`;
                });
        }

        /**
         * Loads ASCII art and flashes it on the screen.
         * @param {string} elementId - The ID of the element to display the art in.
         * @param {string} filePath - The path to the ASCII art text file.
         * @param {number} times - How many times to flash.
         * @param {function} onComplete - Callback function when animation is done.
         */
        async function flashAscii(elementId, filePath, times, onComplete) {
            const element = document.getElementById(elementId);
            try {
                const response = await fetch(filePath);
                const text = await response.text();
                
                let timeoutId;
                let completed = false;

                const skipper = () => {
                    if (completed) return;
                    completed = true;
                    clearTimeout(timeoutId);
                    element.style.visibility = 'visible';
                    element.innerHTML = text;
                    if (onComplete) onComplete();
                    const index = activeSkippers.indexOf(skipper);
                    if (index > -1) {
                        activeSkippers.splice(index, 1);
                    }
                };
                activeSkippers.push(skipper);

                let flashCount = 0;
                const maxFlashes = times * 2; // on/off cycles

                function flash() {
                    if (completed) return;
                    if (flashCount < maxFlashes) {
                        element.style.visibility = (flashCount % 2 === 0) ? 'hidden' : 'visible';
                        if (flashCount === 1) element.innerHTML = text; // Set text on first visible flash
                        flashCount++;
                        timeoutId = setTimeout(flash, 300);
                    } else {
                        completed = true;
                        element.style.visibility = 'visible';
                        element.innerHTML = text; // Ensure it's visible at the end
                        if (onComplete) onComplete();
                        const index = activeSkippers.indexOf(skipper);
                        if (index > -1) {
                            activeSkippers.splice(index, 1);
                        }
                    }
                }
                flash();
            } catch (error) {
                console.error(`Error loading or flashing ASCII art from ${filePath}:`, error);
                element.textContent = `Error: Could not load content from ${filePath}.`;
            }
        }
        
        function showContinueButton() {
            cursor.style.display = 'none';
            continueBtn.style.display = 'block';
            // Add click event listener to button
            continueBtn.addEventListener('click', function() {
                continueBtn.style.display = 'none';
                // Slide the poem section up and out of view
                document.getElementById('poemSection').classList.add('slide-up');
                
                // Animate to heading section
                setTimeout(() => {
                    document.getElementById('headingSection').classList.add('active');
                    startCristinaFlash();
                }, 800); // Wait for slide up transition to finish
            });
        }

        function showContinueButton3() {
            continueBtn3.style.display = 'block';
            continueBtn3.addEventListener('click', function() {
                continueBtn3.style.display = 'none';
                startWithLoveArt();
            });
        }

        function startCristinaFlash() {
            flashAscii('headingText', 'AsciiPieces/Cristina Heading.txt', 3, startLayeredArt);
        }
        
        function startBirthdayText() {
            loadAndAnimateAscii('AsciiPieces/30yoBby.txt', 'birthdayText', {
                charAnimation: 'line',
                lineDelay: 150,
                autoScroll: true,
                onComplete: startLayeredArt
            });
        }

        function startLayeredArt() {
            // Hide previous sections and show the new one
            document.getElementById('headingText').style.display = 'none';
            const layeredArtSection = document.getElementById('layeredArtSection');
            layeredArtSection.style.display = 'flex'; // Make it visible

            loadAndAnimateAscii('AsciiPieces/smolPython.txt', 'python-art', {
                charAnimation: 'line',
                lineDelay: 50,
                autoScroll: true,
                onComplete: startExaltationArt
            });

            // Load the overlay art simultaneously
            loadAndAnimateAscii('AsciiPieces/30yoBby.txt', 'bday-art-overlay', {
                charAnimation: 'line',
                lineDelay: 50,
                autoScroll: true
            });
        }

        function startExaltationArt() {
            // Wait a moment before hiding the previous sections
            setTimeout(() => {
                document.getElementById('headingSection').style.display = 'none';
                document.getElementById('layeredArtSection').style.display = 'none';
                const exaltationSection = document.getElementById('exaltationSection');
                exaltationSection.style.display = 'flex'; // Make it visible
            }, 2000); // 2 second delay

            loadAndAnimateAscii('ExaltationMeditationVocationExplorationRespiration.txt', 'exaltationText', {
                charAnimation: 'line',
                lineDelay: 100,
                autoScroll: true,
                onComplete: showContinueButton3
            });
        }

        function startWithLoveArt() {
            loadAndAnimateAscii('AsciiPieces/Withlove.txt', 'withLoveText', {
                charAnimation: 'line',
                lineDelay: 100,
                autoScroll: true
            });
        }

        function startSaturnArt() {
            loadAndAnimateAscii('AsciiPieces/Saturn.txt', 'saturn-art', {
                charAnimation: 'line',
                lineDelay: 50,
                onComplete: showContinueButton
            });
        }

        // Initial call to start the animation
        document.addEventListener('DOMContentLoaded', (event) => {
            window.scrollTo(0, 0);
            loadAndAnimateAscii('AsciiPieces/Saturn Returns Poem.txt', 'typewriter', {
                charAnimation: 'char',
                charSpeed: 25,
                onComplete: showContinueButton
            });
        });

    </script>
</body>
</html> 